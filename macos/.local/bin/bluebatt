#!/usr/bin/env bash
# Show battery levels of connected Bluetooth devices.
# Usage: bluebatt [filter]

output=$(ioreg -r -k BatteryPercent | awk -F'"' '
  /"Product"/ { name = $4 }
  /"BatteryPercent"/ { gsub(/[^0-9]/, "", $0); print name ": " $0 "%" }
')

[[ -n $1 ]] && output=$(grep -i "$1" <<< "$output")
echo "$output"

#!/usr/bin/env bash
# Search and open files from home directory using fzf.
# Requires: fzf, ripgrep
set -euo pipefail

command -v fzf >/dev/null || { echo "fzf required" >&2; exit 1; }

FZF_OPTS="--reverse --color=bg:-1,bg+:-1,fg+:186,hl:115,hl+:115"
EXCLUDES='--glob "!.git/*" --glob "!*.pyc" --glob "!Library/*" --glob "!.npm/*" --glob "!Movies/*"'

cd "$HOME" || exit 1

target=$(
  FZF_DEFAULT_OPTS="$FZF_OPTS" \
  FZF_DEFAULT_COMMAND="rg --files --hidden $EXCLUDES" \
  fzf --preview 'echo {} | fold -s -w 50' --preview-window=right:70%
) || exit 0

${EDITOR:-vim} "$target"

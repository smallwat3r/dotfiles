#!/usr/bin/env bash
# Open Chrome bookmarks using fzf.
# Requires: fzf, ggrep (brew install grep)
set -euo pipefail

command -v fzf >/dev/null || { echo "fzf required" >&2; exit 1; }
command -v ggrep >/dev/null || { echo "ggrep required (brew install grep)" >&2; exit 1; }

FZF_OPTS="--reverse --color=bg:-1,bg+:-1,fg+:186,hl:115,hl+:115"
BOOKMARKS="$HOME/Library/Application Support/Google/Chrome/Default/Bookmarks"

urls=$(ggrep -Po '"url": \K.*' < "$BOOKMARKS" | tr -d '"')

target=$(echo "$urls" | FZF_DEFAULT_OPTS="$FZF_OPTS" fzf) || exit 0

open -a "/Applications/Google Chrome.app" "$target"

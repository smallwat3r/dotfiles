# Autostart

# Foot terminal server (for fast footclient spawns)
exec foot --server=$XDG_RUNTIME_DIR/foot-launcher.sock --config=$HOME/.config/foot/launcher.ini

# Input method (Fcitx5)
exec fcitx5 -d

# Screen sharing support (xdg-desktop-portal-wlr)
exec dbus-update-activation-environment --systemd WAYLAND_DISPLAY XDG_CURRENT_DESKTOP=sway DISPLAY
exec sleep 1 && systemctl --user restart xdg-desktop-portal xdg-desktop-portal-wlr

# Unlock GNOME Keyring (for Chromium, etc.)
exec eval $(gnome-keyring-daemon --start --components=secrets,pkcs11)

exec_always sh -c 'pkill -x kanshi; sleep 0.5; kanshi -c ~/.config/kanshi/config.gpd'
exec_always sh -c 'pkill -x mako; sleep 0.5; mako'
exec_always sh -c 'pkill -x waybar; sleep 0.5; waybar'
exec_always sh -c 'pkill -x wlsunset; sleep 0.5; wlsunset -l 51.5 -L -0.1'
exec_always sh -c 'pkill -x swayosd-server; sleep 0.5; swayosd-server'

# Clipboard history
exec wl-paste --watch cliphist store

# Automount USB drives
exec udiskie --automount --notify --tray

# System tray applets
# - blueman-applet: Bluetooth device management
# - nm-applet: Network/WiFi management (--indicator for tray icon on Wayland)
# - pasystray: Volume control via PulseAudio/PipeWire
exec blueman-applet
exec nm-applet --indicator
exec pasystray

# YubiKey touch notifications
exec yubikey-touch-detector --libnotify

# Idle and lock
exec swayidle -w \
    timeout 300 'swaylock -f' \
    timeout 600 'swaymsg "output * power off"' \
    resume 'swaymsg "output * power on"' \
    before-sleep 'swaylock'


# smallwat3r's git config

# Identity

[user]
	name = Matthieu Petiteau
	email = mpetiteau.pro@gmail.com
	signingkey = 9964D38A

[github]
	user = smallwat3r

# Core

[init]
	defaultBranch = main
	templatedir = ~/.config/git/templates

[core]
	autocrlf = input                    # Convert CRLF to LF on commit (keep LF on checkout)
	editor = "emacsclient -c"
	hooksPath = ~/.config/git/templates/hooks

[credential]
	helper = !git-credential-pass       # Use pass password manager for credentials

[http]
	postBuffer = 157286400              # 150MB buffer for large pushes

# Signing

[commit]
	gpgsign = true                      # Sign all commits with GPG

[tag]
	gpgsign = true                      # Sign all tags with GPG

# Workflow

[fetch]
	prune = true                        # Remove deleted remote branches on fetch
	fsckobjects = true                  # Validate objects on fetch

[transfer]
	fsckobjects = true                  # Validate objects on transfer

[receive]
	fsckobjects = true                  # Validate objects on receive

[pull]
	rebase = true                       # Rebase instead of merge on pull

[rebase]
	autoStash = true                    # Stash changes before rebase, apply after

[push]
	autoSetupRemote = true              # Auto set upstream on first push

[merge]
	conflictstyle = zdiff3              # Show base, ours, theirs in conflicts

[branch]
	sort = -committerdate               # Sort branches by most recent commit

[diff]
	algorithm = histogram               # Better diff algorithm for clearer output

[rerere]
	enabled = true                      # Remember conflict resolutions

[maintenance]
	auto = true                         # Automatic gc, commit-graph, prefetch

# URL shortcuts
# Usage: git clone gh:user/repo

[url "https://github.com/"]
	insteadOf = gh:

[url "https://gist.github.com/"]
	insteadOf = gist:

[url "https://gitlab.com/"]
	insteadOf = gl:

[url "https://aur.archlinux.org/"]
	insteadOf = aur:

# Output

[column]
	ui = auto                           # Columnar output for branch, status, etc.

[format]
	pretty = format:%Cred%h%Creset - %Cgreen%an -%C(yellow)%d%Creset %s %Cgreen(%cr)%Creset
	date = relative

[color]
	branch = auto
	diff = auto
	status = auto

[color "branch"]
	current = yellow reverse
	local = yellow
	remote = green

[color "diff"]
	meta = yellow bold
	frag = magenta bold
	old = red bold
	new = green bold

[color "status"]
	added = yellow
	changed = green
	untracked = cyan

# Aliases

[alias]
	a = add
	b = branch
	c = commit -v --message
	ca = commit -v --amend --message
	cl = clone
	co = checkout
	cob = "!f() { git checkout -b $@ || (git checkout $@ && echo '!! Reusing existing branch'); }; f"
	com = "!f() { git checkout master || git checkout main; }; f"
	cp = cherry-pick
	d = diff
	find = log --pretty=\"format:%Cgreen%H %Cblue%s\" --name-status --grep
	fl = log -u                         # Show full diff for each commit
	init-empty = "!f() { git init && git commit --allow-empty --allow-empty-message --message ''; }; f"
	l = log
	last-commit-msg = log -1 --format=%s
	ours = "!f() { git co --ours $@ && git add $@; }; f"
	p = push
	pu = pull
	rf = reflog
	rhh = reset --hard HEAD             # Reset to HEAD, discard all changes
	rhr = "!f() { git reset --hard origin/$(git branch --show-current); }; f"
	s = status
	ss = status --short
	theirs = "!f() { git co --theirs $@ && git add $@; }; f"

# Conditional includes

[includeIf "gitdir:~/work/"]
	path = ~/work/.gitconfig            # Work-specific overrides

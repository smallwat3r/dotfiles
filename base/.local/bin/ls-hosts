#!/usr/bin/env bash
# Scan a network subnet and list connected hosts with their details.
# Requires: nmap (with sudo privileges)
# Usage: ls-hosts [subnet]
# Default subnet: 192.168.1.0/24
set -euo pipefail

subnet="${1:-192.168.1.0/24}"

echo "Scanning subnet: $subnet"
printf '%-16s\t%-16s\t%-18s\t%s\n' "IP Address" "Hostname" "MAC Address" "Vendor"
echo "----------------------------------------------------------------------------"

sudo nmap -sn "$subnet" | awk '
/Nmap scan report for/ {
  ip = $NF
  gsub(/[()]/, "", ip)
  hostname = (NF > 5) ? $5 : "N/A"
}
/MAC Address:/ {
  mac = $3
  vendor = substr($0, index($0, $4))
  printf "%-16s\t%-16s\t%-18s\t%s\n", ip, hostname, mac, vendor
}'
